<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><link rel="stylesheet" href="sitewide.css" type="text/css"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.5.2 (457164)"/><meta name="altitude" content="-1.541502475738525"/><meta name="author" content="Alex Balgavy"/><meta name="created" content="2018-10-22 16:02:56 +0000"/><meta name="latitude" content="52.33328663138259"/><meta name="longitude" content="4.866594196780628"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-10-22 16:03:07 +0000"/><title>Longest common subsequence</title></head><body><div><span style="text-decoration: underline;">Problem:</span><br/></div><div>"Find LCS of &lt;N,I,A,C,U,E&gt; and &lt;N,I,C,E,A,C&gt;."</div><div><br/></div><div><span style="text-decoration: underline;">Solution:</span></div><div>Set up a table (2D array):</div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 48px;"/><col style="width: 48px;"/><col style="width: 48px;"/><col style="width: 48px;"/><col style="width: 48px;"/><col style="width: 48px;"/><col style="width: 48px;"/><col style="width: 48px;"/></colgroup><tbody><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>j \ i</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>N</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>I</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>A</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>C</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>U</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>E</div></td></tr><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td></tr><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>N</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td></tr><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>I</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td></tr><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>C</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td></tr><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>E</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td></tr><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>A</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td></tr><tr><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>C</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td><td style="border: 1px solid rgb(219, 219, 219); width: 48px; padding: 8px;"><div><br/></div></td></tr></tbody></table><div><br/></div><div>Then, for every cell:</div><ul><li><div>If letter in row &amp; column is the same, take the number diagonally up to the left and add 1. Place the result in the cell, draw an arrow pointing the cell that’s diagonally up and to the left — A[i-1, j-1]</div></li><li><div>If not, compare neighbour to left and above, take the larger number and place it in the cell. Draw an arrow pointing left or up, depending on which number was used — A[i-1, j] or A[i, j-1]</div></li></ul><div><br/></div><div>The LCS length is the lowest rightmost cell. To find which elements are included in the subsequence, follow the arrows and record every cell that has a diagonal arrow pointing from it (it will be in reverse):</div><div><br/></div><div><img src="Longest%20common%20subsequence.resources/Scannable%20Document%20on%2022%20Oct%202018%20at%2016_55_59.png" height="1236" width="1600"/></div><div><br/></div><div>LCS = 4 — [N, I, A, C]</div><div><br/></div><div><span style="text-decoration: underline;">Worst-case complexity:</span> O(m × n)</div><div><br/></div><div><span style="text-decoration: underline;">Extending:</span></div><div>To turn this into longest common increasing subsequence, create an array of elements from minimum to maximum, and then find LCS between this array and the input.</div></body></html>